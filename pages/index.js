import fs from 'fs'
import path from 'path'
import matter from 'gray-matter'
import Head from 'next/head'
import Post from '../components/Post'
import {sortByDate} from '../utils'
import Link from 'next/link'

export default function Home({ posts }) {
  return (
    <div>
      <Head>
        <title>Pushblock.io</title> 
      </Head>
   
    <div className='main-intro'>
      <img className='logo' alt="pfp" src='/pfp.png'></img>
      <div>
      <p className='intro'>Personal Blog by Justin Ando <br/>Documenting My Coding Journey</p>

    <div className='social-icons'>
   
    <a href="https://github.com/andojustin1337">
    <svg className='github' width="48" height="46" viewBox="0 0 48 46" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path fillRule="evenodd" clipRule="evenodd" d="M24 2.09C11.89 2.09 2.086 11.844 2.086 23.856C2.086 32.676 7.372 40.266 14.98 43.68C15.776 44.038 16.554 43.896 17.162 43.44C17.4982 43.1782 17.7693 42.842 17.9539 42.4579C18.1385 42.0738 18.2316 41.6521 18.226 41.226V40.086L15.512 39.718C15.4919 39.7153 15.4719 39.712 15.452 39.708C13.956 39.416 12.946 38.89 12.206 38.132C11.584 37.494 11.204 36.73 10.882 36.082L10.77 35.856C10.4724 35.2352 10.1474 34.628 9.796 34.036C9.526 33.608 9.316 33.388 9.108 33.25C8.58 32.9 8.072 32.306 8.072 31.564C8.0702 31.3504 8.11592 31.1391 8.20586 30.9454C8.29579 30.7517 8.42769 30.5804 8.592 30.444C8.90211 30.1985 9.2886 30.0696 9.684 30.08C10.128 30.08 10.546 30.216 10.894 30.372C11.25 30.532 11.604 30.744 11.934 30.964C12.738 31.5 13.53 32.134 14.2 32.916C14.898 33.728 15.392 34.244 16.136 34.35C16.748 34.438 17.372 34.44 17.858 34.418C17.9255 34.0332 18.0369 33.6574 18.19 33.298C17.5964 33.1595 17.0109 32.9886 16.436 32.786C15.128 32.322 13.67 31.6 12.69 30.506C11.614 29.302 10.948 28.228 10.576 26.972C10.214 25.748 10.154 24.422 10.154 22.79C10.154 20.29 11.236 18.184 12.048 17.066C11.736 16.0872 11.5118 15.0826 11.378 14.064C11.2894 13.4217 11.2901 12.7702 11.38 12.128C11.48 11.542 11.73 10.822 12.388 10.388C13.022 9.966 13.766 9.984 14.346 10.092C14.948 10.206 15.574 10.456 16.15 10.742C17.088 11.206 18.02 11.826 18.718 12.352C19.922 11.998 22.052 11.542 23.978 11.5H24.022C25.95 11.542 27.984 11.998 29.158 12.35C29.858 11.826 30.788 11.204 31.724 10.742C32.3 10.456 32.924 10.206 33.528 10.092C34.108 9.984 34.852 9.966 35.488 10.386C36.144 10.822 36.396 11.542 36.494 12.128C36.596 12.738 36.572 13.42 36.494 14.064C36.3608 15.0825 36.1372 16.0871 35.826 17.066C36.638 18.186 37.72 20.292 37.72 22.79C37.72 24.422 37.66 25.748 37.3 26.97C36.926 28.23 36.26 29.302 35.184 30.506C34.204 31.6 32.746 32.322 31.438 32.786C30.7437 33.03 30.0342 33.2285 29.314 33.38C29.56 34.124 29.648 34.726 29.648 35.072V41.252C29.648 42.192 30.086 42.994 30.708 43.462C31.312 43.92 32.088 44.062 32.884 43.714C40.564 40.33 45.912 32.72 45.912 23.854C45.912 11.844 36.112 2.09 24 2.09ZM18.952 36.42C18.432 36.494 18.95 36.42 18.95 36.42H18.944L18.928 36.424L18.87 36.432C18.5729 36.4669 18.2748 36.4916 17.976 36.506C17.2642 36.5431 16.5505 36.5143 15.844 36.42C14.262 36.196 13.3 35.076 12.678 34.348L12.618 34.28C12.4146 34.0441 12.1962 33.8216 11.964 33.614C12.17 33.994 12.384 34.418 12.614 34.874L12.634 34.914L12.736 35.122C13.086 35.818 13.316 36.282 13.698 36.67C14.07 37.05 14.65 37.418 15.822 37.65L19.41 38.136C19.6606 38.1699 19.8904 38.2936 20.0566 38.4842C20.2229 38.6747 20.3143 38.9191 20.314 39.172V41.226C20.314 42.826 19.564 44.252 18.414 45.116C17.8102 45.5773 17.092 45.8651 16.3367 45.9483C15.5814 46.0315 14.8177 45.9069 14.128 45.588C5.804 41.854 0 33.54 0 23.856C0 10.672 10.754 0 24 0C37.246 0 48 10.672 48 23.856C48 33.59 42.122 41.926 33.726 45.628C33.0357 45.9408 32.2734 46.0601 31.5206 45.9731C30.7677 45.8861 30.0527 45.5961 29.452 45.134C28.858 44.6767 28.3781 44.0881 28.0499 43.4142C27.7216 42.7403 27.5539 41.9996 27.56 41.25V35.07C27.56 34.93 27.462 34.122 26.916 33.036C26.8406 32.8854 26.8027 32.7189 26.8053 32.5505C26.808 32.3821 26.8511 32.2169 26.9312 32.0687C27.0113 31.9206 27.1258 31.7939 27.2652 31.6994C27.4046 31.605 27.5647 31.5455 27.732 31.526C28.7573 31.3975 29.7658 31.1588 30.74 30.814C31.928 30.394 32.994 29.818 33.628 29.11C34.57 28.058 35.04 27.25 35.298 26.376C35.566 25.47 35.634 24.416 35.634 22.79C35.634 20.508 34.434 18.59 33.882 17.972C33.7567 17.8323 33.6713 17.6615 33.6347 17.4775C33.5981 17.2935 33.6117 17.103 33.674 16.926C34.0295 15.9183 34.2808 14.8769 34.424 13.818C34.488 13.268 34.492 12.808 34.436 12.476C34.4235 12.3546 34.3867 12.237 34.328 12.13C34.1903 12.1062 34.0491 12.1123 33.914 12.148C33.574 12.212 33.14 12.372 32.648 12.616C31.668 13.1 30.648 13.816 30.016 14.328C29.8766 14.4411 29.7104 14.5162 29.5334 14.5459C29.3564 14.5757 29.1747 14.5592 29.006 14.498C27.3867 13.9683 25.7023 13.6634 24 13.592C21.986 13.64 19.662 14.212 18.868 14.498C18.6993 14.5592 18.5176 14.5757 18.3406 14.5459C18.1636 14.5162 17.9974 14.4411 17.858 14.328C17.0407 13.67 16.1588 13.0964 15.226 12.616C14.8254 12.4056 14.3992 12.2483 13.958 12.148C13.8235 12.1126 13.683 12.1065 13.546 12.13C13.4872 12.2369 13.4505 12.3546 13.438 12.476C13.382 12.808 13.386 13.268 13.45 13.818C13.5941 14.8767 13.8454 15.9181 14.2 16.926C14.326 17.286 14.248 17.686 13.992 17.972C13.44 18.59 12.24 20.508 12.24 22.79C12.24 24.414 12.308 25.47 12.576 26.376C12.836 27.25 13.304 28.056 14.244 29.11C14.88 29.818 15.944 30.394 17.134 30.814C18.1075 31.1585 19.1154 31.3972 20.14 31.526C20.3508 31.5486 20.5497 31.6349 20.7103 31.7733C20.8709 31.9118 20.9855 32.0959 21.0389 32.301C21.0923 32.5062 21.082 32.7228 21.0093 32.922C20.9366 33.1211 20.805 33.2935 20.632 33.416C20.302 33.652 20.084 34.076 19.962 34.566C19.899 34.8183 19.8615 35.0762 19.85 35.336V35.374C19.8525 35.6276 19.7629 35.8735 19.5977 36.0659C19.4325 36.2583 19.203 36.3841 18.952 36.42V36.42Z" fill="white"/>
    </svg>
    </a>

    <a href="https://twitter.com/jstn_ando">
    <svg className='twitter' width="51" height="51" viewBox="0 0 50 50" fill="none" xmlns="http://www.w3.org/2000/svg">
    <path d="M25 0.948975C11.7385 0.948975 0.94751 11.737 0.94751 25C0.94751 38.263 11.7385 49.051 25 49.051C38.2615 49.051 49.0525 38.263 49.0525 25C49.0525 11.737 38.2615 0.948975 25 0.948975ZM25 47.449C12.622 47.449 2.55251 37.378 2.55251 25C2.55251 12.622 12.622 2.55097 25 2.55097C37.378 2.55097 47.4475 12.622 47.4475 25C47.4475 37.378 37.378 47.449 25 47.449Z" fill="white"/>
    <path d="M38.191 17.569C38.3574 17.261 38.4945 16.9381 38.6005 16.6045C38.6496 16.4497 38.6506 16.2837 38.6034 16.1284C38.5562 15.9731 38.4629 15.8358 38.336 15.7345C38.2091 15.6333 38.0545 15.5729 37.8926 15.5614C37.7306 15.5499 37.569 15.5877 37.429 15.67C36.6604 16.1266 35.8284 16.4668 34.96 16.6795C33.9059 15.7281 32.537 15.2007 31.117 15.199C30.3456 15.1996 29.5823 15.3559 28.8727 15.6587C28.1632 15.9614 27.5221 16.4043 26.9878 16.9608C26.4536 17.5173 26.0373 18.176 25.7637 18.8973C25.4902 19.6186 25.3651 20.3877 25.396 21.1585C22.0226 20.7338 18.942 19.0267 16.7935 16.3915C16.7112 16.2916 16.606 16.2131 16.4869 16.1627C16.3677 16.1122 16.2382 16.0912 16.1092 16.1015C15.9802 16.1118 15.8556 16.1531 15.746 16.2219C15.6364 16.2906 15.545 16.3848 15.4795 16.4965C14.9876 17.3409 14.7202 18.2972 14.7028 19.2743C14.6855 20.2514 14.9188 21.2167 15.3805 22.078C15.2673 22.0971 15.1585 22.1367 15.0595 22.195C14.9383 22.2723 14.8384 22.3789 14.7692 22.505C14.7 22.6311 14.6637 22.7726 14.6635 22.9165C14.6635 24.619 15.421 26.182 16.642 27.244L16.5895 27.2965C16.4974 27.4008 16.4339 27.5272 16.4055 27.6635C16.3771 27.7997 16.3847 27.941 16.4275 28.0735C16.6821 28.8678 17.1073 29.5968 17.6731 30.2096C18.239 30.8224 18.932 31.3041 19.7035 31.621C18.1189 32.394 16.3456 32.6955 14.5945 32.4895C14.4145 32.4711 14.2336 32.513 14.0799 32.6086C13.9263 32.7041 13.8087 32.8479 13.7455 33.0175C13.6849 33.1883 13.6838 33.3746 13.7423 33.5461C13.8008 33.7176 13.9156 33.8644 14.068 33.9625C16.4486 35.4903 19.2179 36.302 22.0465 36.301C31.3165 36.301 36.8575 28.771 36.8575 21.4915L36.856 21.2455C37.7544 20.5441 38.5348 19.7035 39.1675 18.7555C39.2634 18.6122 39.3105 18.4418 39.3019 18.2696C39.2934 18.0974 39.2296 17.9326 39.12 17.7995C39.0105 17.6664 38.861 17.5721 38.6937 17.5306C38.5263 17.489 38.3501 17.5025 38.191 17.569V17.569ZM35.5735 20.2015C35.4647 20.2797 35.3772 20.384 35.319 20.5048C35.2608 20.6256 35.2339 20.7591 35.2405 20.893C35.2495 21.091 35.254 21.292 35.254 21.49C35.254 27.982 30.3145 34.6975 22.048 34.6975C20.5737 34.6982 19.1098 34.4507 17.7175 33.9655C19.3849 33.6459 20.9513 32.9309 22.285 31.8805C22.4149 31.7781 22.5099 31.6381 22.5572 31.4797C22.6044 31.3213 22.6016 31.1521 22.5491 30.9953C22.4966 30.8386 22.3969 30.7018 22.2637 30.6039C22.1305 30.5059 21.9703 30.4515 21.805 30.448C21.1583 30.4356 20.5235 30.2714 19.9518 29.9687C19.3802 29.6659 18.8877 29.233 18.514 28.705C18.8935 28.6795 19.2655 28.6165 19.627 28.519C19.802 28.4722 19.9559 28.3674 20.0637 28.2219C20.1715 28.0763 20.2267 27.8985 20.2205 27.7175C20.2142 27.5365 20.1468 27.363 20.0292 27.2252C19.9116 27.0874 19.7508 26.9936 19.573 26.959C18.8426 26.8104 18.1662 26.466 17.6164 25.9627C17.0666 25.4593 16.6639 24.816 16.4515 24.1015C16.8505 24.202 17.26 24.2605 17.6695 24.274C18.022 24.2725 18.349 24.0565 18.4585 23.7175C18.568 23.3785 18.439 23.005 18.1405 22.807C17.4347 22.3367 16.8913 21.6601 16.5845 20.8695C16.2776 20.0788 16.2223 19.2127 16.426 18.3895C19.0316 21.0629 22.5499 22.655 26.278 22.8475C26.542 22.849 26.773 22.7545 26.9335 22.561C27.094 22.3675 27.1555 22.111 27.0985 21.865C26.8934 20.9815 26.9851 20.055 27.3596 19.2289C27.7341 18.4028 28.3704 17.7232 29.1701 17.2951C29.9697 16.8671 30.8882 16.7146 31.7833 16.8612C32.6783 17.0078 33.5002 17.4453 34.1215 18.106C34.2147 18.2053 34.3316 18.2794 34.4612 18.3211C34.5908 18.3628 34.7289 18.3709 34.8625 18.3445C35.11 18.295 35.3545 18.238 35.596 18.172C35.4872 18.2535 35.374 18.3291 35.257 18.3985C35.1015 18.4938 34.983 18.6392 34.9212 18.8108C34.8594 18.9824 34.8579 19.17 34.9169 19.3426C34.976 19.5151 35.092 19.6625 35.246 19.7603C35.4 19.858 35.5827 19.9004 35.764 19.8805L36.037 19.846C35.8867 19.9698 35.7321 20.0884 35.5735 20.2015V20.2015Z" fill="white"/>
    </svg>
    </a>

    </div>

      </div>  
    </div>
  
    <div className='posts'>
        {posts.map((post, index) => (
          <Post key={index} post={post} />
        ))}
      </div> 
    </div>  
  )
}

export async function getStaticProps() {
  // Get files from the posts dir
  const files = fs.readdirSync(path.join('posts'))

  // Get slug and frontmatter from posts
  const posts = files.map(filename => {
    // Create slug
    const slug = filename.replace('.md', '')

    // Get frontmatter
    const markdownWithMeta = fs.readFileSync(path.join('posts',
    filename), 'utf-8')

    const {data:frontmatter} = matter(markdownWithMeta)

    return {
      slug,
      frontmatter,
    }
  })

  return {
    props: {
      posts: posts.sort(sortByDate),
    },
  }
}